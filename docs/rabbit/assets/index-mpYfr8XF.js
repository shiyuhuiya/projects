import{x as O,y as z,z as B,A as $,B as D,_ as P,r as E,h as U,i as j,o as S,c as T,e as b,a as _,w as m,n as I,t as y,m as R,p as K,j as F,F as M,b as Y,u as q,C as G,D as L}from"./index-CNV5tPLO.js";import{E as J,a as Q}from"./tab-pane-paRGdom0.js";import{E as W,a as X}from"./breadcrumb-item-BicK8QLd.js";import{g as Z}from"./position-D3PGF8Pq.js";const c="ElInfiniteScroll",ee=50,te=200,se=0,oe={delay:{type:Number,default:te},distance:{type:Number,default:se},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},A=(e,s)=>Object.entries(oe).reduce((t,[o,n])=>{var l,i;const{type:p,default:u}=n,d=e.getAttribute(`infinite-scroll-${o}`);let a=(i=(l=s[d])!=null?l:d)!=null?i:u;return a=a==="false"?!1:a,a=p(a),t[o]=Number.isNaN(a)?u:a,t},{}),V=e=>{const{observer:s}=e[c];s&&(s.disconnect(),delete e[c].observer)},ae=(e,s)=>{const{container:t,containerEl:o,instance:n,observer:l,lastScrollTop:i}=e[c],{disabled:p,distance:u}=A(e,n),{clientHeight:d,scrollHeight:a,scrollTop:r}=o,v=r-i;if(e[c].lastScrollTop=r,l||p||v<0)return;let g=!1;if(t===e)g=a-(d+r)<=u;else{const{clientTop:h,scrollHeight:C}=e,w=Z(e,o);g=r+d>=w+h+C-u}g&&s.call(n)};function N(e,s){const{containerEl:t,instance:o}=e[c],{disabled:n}=A(e,o);n||t.clientHeight===0||(t.scrollHeight<=t.clientHeight?s.call(o):V(e))}const ne={async mounted(e,s){const{instance:t,value:o}=s;O(o)||z(c,"'v-infinite-scroll' binding value must be a function"),await B();const{delay:n,immediate:l}=A(e,t),i=$(e,!0),p=i===window?document.documentElement:i,u=D(ae.bind(null,e,o),n);if(i){if(e[c]={instance:t,container:i,containerEl:p,delay:n,cb:o,onScroll:u,lastScrollTop:p.scrollTop},l){const d=new MutationObserver(D(N.bind(null,e,o),ee));e[c].observer=d,d.observe(e,{childList:!0,subtree:!0}),N(e,o)}i.addEventListener("scroll",u)}},unmounted(e){if(!e[c])return;const{container:s,onScroll:t}=e[c];s==null||s.removeEventListener("scroll",t),V(e)},async updated(e){if(!e[c])await B();else{const{containerEl:s,cb:t,observer:o}=e[c];s.clientHeight&&o&&N(e,t)}}},x=ne;x.install=e=>{e.directive("InfiniteScroll",x)};const le=x,re={class:"subCategory"},ie={class:"container"},ce={class:"goods"},ue=["infinite-scroll-disabled"],de={alt:""},_e={class:"name ellipsis"},pe={class:"desc ellipsis"},fe={class:"price"},be={__name:"index",setup(e){const s=q(),t=E({});(async a=>{const r=await G(a);t.value=r.result})(s.params.id);const n=E([]),l=E({categoryId:t.value.id,page:1,pageSize:20,sortField:"publishTime"}),i=async a=>{const r=await L(a);n.value=r.result.items};i(l.value);const p=()=>{l.value.page=1,i(l.value)},u=E(!1),d=async()=>{l.value.page+=1;const r=(await L(l.value)).result.items;r.length==0&&(u.value=!0),n.value=[...n.value,...r]};return(a,r)=>{const v=W,g=X,h=J,C=Q,w=U("router-link"),H=j("lazy-load"),k=le;return S(),T("div",re,[b("div",ie,[_(g,{"separator-icon":R(K)},{default:m(()=>[_(v,{to:{path:"/"}},{default:m(()=>[I("首页")]),_:1}),_(v,{to:{path:`/category/${t.value.parentId}`}},{default:m(()=>[I(y(t.value.parentName),1)]),_:1},8,["to"]),_(v,{to:{path:`/category/sub/${t.value.id}`}},{default:m(()=>[I(y(t.value.name),1)]),_:1},8,["to"])]),_:1},8,["separator-icon"]),b("div",ce,[_(C,{modelValue:l.value.sortField,"onUpdate:modelValue":r[0]||(r[0]=f=>l.value.sortField=f),class:"demo-tabs",onTabChange:p},{default:m(()=>[_(h,{label:"最新商品",name:"pubishTime"}),_(h,{label:"最高人气",name:"orderNum"}),_(h,{label:"评论最多",name:"evaluateNum"})]),_:1},8,["modelValue"]),F((S(),T("ul",{"infinite-scroll-disabled":u.value,class:"body"},[(S(!0),T(M,null,Y(n.value,f=>(S(),T("li",{key:f.id},[_(w,{to:`/detail/${f.id}`},{default:m(()=>[F(b("img",de,null,512),[[H,f.picture]]),b("p",_e,y(f.name),1),b("p",pe,y(f.desc),1),b("p",fe,y(f.price),1)]),_:2},1032,["to"])]))),128))],8,ue)),[[k,d]])])])])}}},ye=P(be,[["__scopeId","data-v-1acf7e0e"]]);export{ye as default};
