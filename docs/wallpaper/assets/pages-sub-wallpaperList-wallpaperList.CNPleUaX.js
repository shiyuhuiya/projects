import{e as a,B as e,q as l,C as s,f as t,c as u,w as i,d as o,o as r,a as c,g as p,h as n,F as v,p as m,D as d,l as g,j as f}from"./index-CnChCGCE.js";import{_}from"./uni-load-more.CWAKb8WI.js";import{_ as w,e as j,d as P,a as b,r as y}from"./uni-app.es.DI07t6-z.js";import{_ as h}from"./uni-icons.ZeMslxzL.js";import{r as N}from"./index.BK6dp0vN.js";import{u as z}from"./picList.DYLfFDIO.js";import{a as L}from"./user.Cu_8grgC.js";const S=w({__name:"wallpaperList",setup(w){const S=a({pageNum:1,pageSize:9}),T=a(0);j((({id:a,type:l,name:s,Total:t=-1,keyword:u})=>{e({title:s}),S.value.classid=a,S.value.type=l,S.value.keyword=u,-1!=t&&(T.value=+t),x()}));const k=z();async function x(a){if(S.value.classid){const a=await(({classid:a,pageNum:e=1,pageSize:l=9})=>N({url:"/wallList",data:{classid:a,pageNum:e,pageSize:l}}))(S.value);T.value=a.data.total;const e=a.data.data;e.forEach((a=>{a.bigPic=a.smallPicurl.replace(/_small.webp/,".jpg")})),q.value=[...q.value,...e],k.setPicList(q.value)}else if(S.value.type){const a=(await L(S.value)).data.data;a.forEach((a=>{a.bigPic=a.smallPicurl.replace(/_small.webp/,".jpg")})),q.value=[...q.value,...a],k.setPicList(q.value)}else{const a=await(a=>N({url:"/searchWall",data:{...a}}))(S.value);T.value=a.data.total;const e=a.data.data;e.forEach((a=>{a.bigPic=a.smallPicurl.replace(/_small.webp/,".jpg")})),q.value=[...q.value,...e],k.setPicList(q.value)}a&&a()}let E=null;const C=a(!1);P((()=>{S.value.pageNum*S.value.pageSize>=T.value||(E&&clearTimeout(E),E=setTimeout((()=>{S.value.pageNum+=1,x((()=>{l()}))}),500))}));const q=a([]);s(q,(()=>{S.value.pageNum*S.value.pageSize>=T.value&&(C.value=!0)}));return b((()=>{q.value=[],S.value.pageNum=1,x((()=>{l()}))})),(a,e)=>{const l=g,s=f,w=o,j=y(t("uni-load-more"),_),P=y(t("uni-icons"),h);return r(),u(w,{class:"container"},{default:i((()=>[c(w,{class:"content"},{default:i((()=>[(r(!0),p(v,null,n(q.value,((a,e)=>(r(),u(s,{class:"pic",id:a._id,url:`/pages/sub/preview/preview?index=${e}`},{default:i((()=>[c(l,{src:a.smallPicurl},null,8,["src"])])),_:2},1032,["id","url"])))),256))])),_:1}),0!=q.value.length?(r(),u(j,{key:0,status:C.value?"noMore":"more"},null,8,["status"])):m("",!0),c(w,{class:"goTop",onClick:e[0]||(e[0]=a=>{d({scrollTop:0})})},{default:i((()=>[c(P,{type:"arrow-up",size:"30"})])),_:1})])),_:1})}}},[["__scopeId","data-v-ee017f4e"]]);export{S as default};
